---
title: 4-6. Elasticsearch
date: 2023-07-04
---
## 整合ES
#### 1. 依赖
这里选择官方推出的可以操作ES8.x的最新版客户端依赖。

同时操作ES的API经常需要使用JSON格式的数据，因此同时添加一个JSON工具依赖
```xml
<dependency>
    <groupId>co.elastic.clients</groupId>
    <artifactId>elasticsearch-java</artifactId>
    <!-- version与ES服务端的version一致 -->
    <version>8.7.0</version> 
<dependency>

<!--工具：Java对象转JSON -->
<dependency>
    <groupId>com.fasterxml.jackson.core</groupId>
    <artifactId>jackson-databind</artifactId>
    <version>2.15.2</version>
</dependency>
```


#### 2. ES客户端的版本变迁
- RestLowLevelClient：最初的ES客户端，该客户端也被低版本的SpringBoot内置
    - 被spring-boot-starter-data-elasticsearch集成
- RestHighLevelClient：之后RestLowLevelClient客户端被弃用，SpringBoot没有及时更新，因此当时需要手动添加ES的依赖。不过后来SpringBoot集成了该API。
- ElasticSearchClient：在ES7.15版本之后RRestHighLevelClient客户端也被弃用了，推出了Elasticsearch Java API Client，该客户端可以操作ES8.x
- 高版本的SpringData已经内置了最新的客户端：详见[SpringData ES](https://docs.spring.io/spring-data/elasticsearch/docs/current/reference/html/)，直接使用SpringData也是一种选择。

spring-boot-starter-data-elasticsearch的更新速度很慢，虽然简化了操作，但无法适配高版本的ES服务，因此推荐采用Elasticsearch Java API Client。该客户端需要手动导入，并指定版本，版本号与服务器开启的ES服务版本号一致。

#### 3. application.yml
注意：由于没有采用spring-boot-starter-data-elasticsearch 集成的ES客户端，因此在application.yml中进行的配置仅仅起到了变量的作用，SpringBoot是无法帮忙直接连接ES服务的。

