---
title: 1-4. 库与集合
date: 2023-04-09
---
## Ⅰ. 数据库操作

#### 1. 查看所有数据库

::: tip

只能查看有权限的数据库，MongoDB会默认创建以下三个数据库：  
- admin：从权限的角度来看，这是"root"数据库。要是将一个用户添加到这个数据库，这个用户自动继承所有数据库的权限。一些特定的服务器端命令也只能从这个数据库运行，比如列出所有的数据库或者关闭服务器。
- local：这个数据永远不会被复制，可以用来存储限于本地单台服务器的任意集合。
- conﬁg: 当Mongo用于分片设置时，conﬁg数据库在内部使用，用于保存分片的相关信息。

:::

**命令**
```shell
show dbs
show databases
```


#### 2. 选择或创建数据库
数据库存在就是选择，数据库不存在就是创建。
``` shell
use 数据库名称
```
**数据库名规范**
- 不能是空字符串（"")。
- 不得含有' '（空格)、.、`$`、/、\和\0 (空字符)。
- 应全部小写


#### 3. 查看正在使用的数据库
MongoDB 中默认的数据库为 test，如果你没有选择数据库，集合将存放在 test 数据库中。
```shell
db
```

#### 4. 数据库删除
主要用来删除已经持久化的数据库。  
语法和JS类似，db对象调用dropDatabase方法删除当前数据库，db指的是当前use的数据库。
```shell
db.dropDatabase()
```

#### 5. 数据库的状态
当数据库中没有数据时，数据库默认只存在与内存中，而没有在硬盘中。   
使用show dbs查看数据库时，不会显示只存在于内存中的数据库，不过使用db命令可以看到当前使用的仅存在于内存中的数据库。


## Ⅱ. 集合操作

集合，类似关系型数据库中的表。

#### 1. 查看当前库中的集合
```shell
show collections 
或
show tables
```
#### 2. 创建集合
当向一个集合中插入一个文档的时候，如果集合不存在，则会自动创建集合。  
也可以手动创建集合（不推荐）
```shell
db.createCollection(name)
//示例
db.createCollection('user')
```
**集合的命名规范**
- 集合名不能是空字符串""。
- 集合名不能含有\0字符（空字符)，这个字符表示集合名的结尾。
- 集合名不能以"system."开头，这是为系统集合保留的前缀。
- 用户创建的集合名字不能含有保留字符。有些驱动程序的确支持在集合名里面包含，这是因为某些系统生成的集合中包含该字符。除非你要访问这种系统创建的集合，否则千万不要在名字里出现`$`

#### 3. 删除集合
如果成功删除选定集合，这返回true，否则返回false
```shell
db.集合名.drop()
```



